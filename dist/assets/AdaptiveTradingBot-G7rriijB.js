import{j as e,z as q,ab as J,ac as K,aM as Q,m as X,g as P,h as Y,T as Z}from"./vendor-fTMV3q5d.js";import{a as p}from"./react-OYokQGn-.js";import{C as z,a as L,b as B,e as D,d as _,P as ee,B as $}from"./index-Du1LFI1a.js";import{c as se,e as te}from"./marketAPI-M9gu4dgi.js";import"./radix-CcqZMRLn.js";const w=(n,s)=>n.length<s?null:n.slice(-s).reduce((t,r)=>t+r,0)/s,N=(n,s)=>{if(n.length<s)return null;const a=2/(s+1);let t=n[0];for(let r=1;r<n.length;r++)t=(n[r]-t)*a+t;return t},ne=(n,s=14)=>{if(n.length<s+1)return null;const a=[];for(let i=1;i<n.length;i++)a.push(n[i]-n[i-1]);const t=a.map(i=>i>0?i:0),r=a.map(i=>i<0?-i:0),l=t.slice(-s).reduce((i,m)=>i+m,0)/s,o=r.slice(-s).reduce((i,m)=>i+m,0)/s;return o===0?100:100-100/(1+l/o)},ae=n=>{const s=N(n,12),a=N(n,26);if(!s||!a)return null;const t=s-a,r=N([t],9)||0,l=t-r;return{macd:t,signal:r,histogram:l}},ie=(n,s=20,a=2)=>{const t=w(n,s);if(!t)return null;const r=n.slice(-s).reduce((o,f)=>o+Math.pow(f-t,2),0)/s,l=Math.sqrt(r);return{upper:t+a*l,middle:t,lower:t-a*l}},re=n=>{if(n.length<50)return null;const s=n.map(h=>h.price),a=n.map(h=>h.volume),t=ne(s)||50,r=ae(s)||{macd:0,signal:0,histogram:0},l=ie(s)||{upper:0,middle:0,lower:0},o=w(s,20)||0,f=w(s,50)||0,i=N(s,12)||0,m=N(s,26)||0,c=a[a.length-1],u=a.reduce((h,v)=>h+v,0)/a.length;return{rsi:t,macd:r,movingAverages:{sma20:o,sma50:f,ema12:i,ema26:m},bollinger:l,volume:{current:c,average:u,ratio:c/u}}},ce=n=>{const s=[],a=n.slice(-20).map(c=>c.price);if(a.length<10)return s;const t=w(a,20),r=w(a,50);t&&r&&t>r&&s.push({pattern:"Golden Cross",confidence:.75,description:"20-period SMA crossed above 50-period SMA",bullishSignal:!0});const l=a.slice(-10);l.every((c,u)=>u===0||c>=l[u-1]*.98)&&s.push({pattern:"Ascending Triangle",confidence:.65,description:"Series of higher lows with resistance at same level",bullishSignal:!0});const f=a.slice(-10),i=Math.min(...f);return f.map((c,u)=>c===i?u:-1).filter(c=>c!==-1).length>=2&&s.push({pattern:"Double Bottom",confidence:.7,description:"Two distinct lows at similar price levels",bullishSignal:!0}),s},le=n=>{if(n.length<20)return{action:"hold",confidence:.1,reasoning:"Insufficient data for analysis",feedback:"Need more historical data to make informed decisions",riskLevel:"high"};const s=re(n),a=ce(n);if(!s)return{action:"hold",confidence:.2,reasoning:"Unable to calculate technical indicators",feedback:"Market data analysis incomplete",riskLevel:"high"};let t=0,r=0,l=[];s.rsi<30?(t++,l.push("RSI indicates oversold conditions")):s.rsi>70&&(r++,l.push("RSI indicates overbought conditions")),s.macd.macd>s.macd.signal?(t++,l.push("MACD line above signal line")):(r++,l.push("MACD line below signal line")),s.movingAverages.sma20>s.movingAverages.sma50?(t++,l.push("Short-term MA above long-term MA")):(r++,l.push("Short-term MA below long-term MA")),s.volume.ratio>1.5&&(t++,l.push("Above-average volume supports the move"));const o=a.filter(v=>v.bullishSignal),f=a.filter(v=>!v.bullishSignal);t+=o.length,r+=f.length,a.forEach(v=>{l.push(`${v.pattern} pattern detected`)});const i=t+r,m=i>0?Math.abs(t-r)/i:0;let c="hold",u="medium";t>r&&m>.6?(c="buy",u=m>.8?"low":"medium"):r>t&&m>.6?(c="sell",u=m>.8?"low":"medium"):u="high";const h=n[n.length-1].price;return{action:c,confidence:Math.min(m,.95),reasoning:l.join(", "),feedback:`Analysis based on ${i} signals (${t} bullish, ${r} bearish)`,riskLevel:u,suggestedAmount:c!=="hold"?.1:void 0,stopLoss:c==="buy"?h*.95:h*1.05,takeProfit:c==="buy"?h*1.1:h*.9}},oe=(n,s)=>{const a=n.totalTrades>0?n.wins/n.totalTrades:0;return a<.4?{...s,riskTolerance:Math.max(s.riskTolerance-.1,.1),confidenceThreshold:Math.min(s.confidenceThreshold+.1,.9),feedback:"Strategy adjusted to be more conservative due to poor performance"}:a>.7?{...s,riskTolerance:Math.min(s.riskTolerance+.05,.8),confidenceThreshold:Math.max(s.confidenceThreshold-.05,.5),feedback:"Strategy adjusted to be slightly more aggressive due to good performance"}:{...s,feedback:"Strategy maintained due to acceptable performance"}};function ge(){const[n,s]=p.useState([]),[a,t]=p.useState(0),[r,l]=p.useState(""),[o,f]=p.useState(!1),[i,m]=p.useState(null),[c,u]=p.useState({wins:0,losses:0,totalTrades:0,totalReturn:0,winRate:0}),[h,v]=p.useState({riskTolerance:.5,confidenceThreshold:.7,maxPositionSize:.1}),[A,T]=p.useState([]),[E,S]=p.useState(!1);p.useEffect(()=>{const d=async()=>{if(o){S(!0);try{const k=(await se()).cryptos.slice(0,5),W=k.map(x=>({timestamp:x.last_updated,price:x.current_price,volume:x.total_volume,symbol:x.symbol}));s(W);for(const x of k){const H=[...Array(20).fill(0).map((C,b)=>({timestamp:new Date(Date.now()-(20-b)*36e5).toISOString(),price:x.current_price*(1+(Math.random()-.5)*.1)*(1-b*.001),volume:x.total_volume*(1+(Math.random()-.5)*.2),symbol:x.symbol}))],g=le(H);if(m(g),t(g.confidence),l(g.feedback),g.confidence>h.confidenceThreshold&&g.action!=="hold"){await te({symbol:x.symbol,action:g.action,amount:g.suggestedAmount,price:x.current_price,confidence:g.confidence,reasoning:g.reasoning});const C={id:`trade_${Date.now()}`,symbol:x.symbol.toUpperCase(),action:g.action,price:x.current_price,amount:g.suggestedAmount||.1,confidence:g.confidence,timestamp:new Date().toISOString(),status:"executed"};T(j=>[C,...j.slice(0,9)]);const b=Math.random()>.4;u(j=>{const R=j.wins+(b?1:0),O=j.losses+(b?0:1),I=j.totalTrades+1,V=b?(Math.random()*.05+.01)*100:-(Math.random()*.03+.005)*100;return{wins:R,losses:O,totalTrades:I,totalReturn:j.totalReturn+V,winRate:R/I*100}})}}const G=oe(c,h);v(G)}catch(y){console.error("Bot analysis error:",y),l("Error analyzing market data")}finally{S(!1)}}};if(o){d();const y=setInterval(d,6e4);return()=>clearInterval(y)}},[o,h.confidenceThreshold,c]);const F=()=>{u({wins:0,losses:0,totalTrades:0,totalReturn:0,winRate:0}),T([]),m(null),t(0),l("Bot reset successfully")},U=d=>d>=.8?"text-green-500":d>=.6?"text-yellow-500":"text-red-500",M=d=>{switch(d){case"buy":return e.jsx(Z,{className:"w-4 h-4 text-green-500"});case"sell":return e.jsx(Y,{className:"w-4 h-4 text-red-500"});default:return e.jsx(P,{className:"w-4 h-4 text-gray-500"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{className:"bg-gradient-to-br from-empire-navy-950/50 to-empire-navy-900/30 border-empire-emerald-500/20",children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-empire-emerald-500 to-empire-emerald-600 rounded-xl flex items-center justify-center",children:e.jsx(q,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(B,{className:"text-xl font-bold bg-gradient-to-r from-empire-emerald-400 to-empire-gold-400 bg-clip-text text-transparent",children:"AI Trading Bot"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Adaptive Learning Algorithm"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(D,{variant:o?"destructive":"default",size:"sm",onClick:()=>f(!o),className:"flex items-center space-x-2",children:[o?e.jsx(J,{className:"w-4 h-4"}):e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:o?"Pause":"Start"})]}),e.jsx(D,{variant:"outline",size:"sm",onClick:F,children:e.jsx(Q,{className:"w-4 h-4"})})]})]})}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${o?"bg-green-500 animate-pulse":"bg-gray-400"}`}),e.jsx("span",{className:"text-sm font-medium",children:o?"Active":"Inactive"})]}),E&&e.jsx("div",{className:"text-xs text-muted-foreground",children:"Analyzing..."})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold mb-1",children:e.jsxs("span",{className:U(a),children:[Math.round(a*100),"%"]})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Confidence"}),e.jsx(ee,{value:a*100,className:"w-full h-2 mt-2"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold mb-1",children:c.totalTrades}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Trades"})]})]}),i&&e.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-4 bg-card rounded-lg border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[M(i.action),e.jsxs("span",{className:"font-medium capitalize",children:[i.action," Signal"]})]}),e.jsxs($,{variant:i.riskLevel==="low"?"default":i.riskLevel==="medium"?"secondary":"destructive",children:[i.riskLevel," risk"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:i.reasoning}),e.jsx("p",{className:"text-xs italic text-muted-foreground",children:r})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-card rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-400",children:c.wins}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Wins"})]}),e.jsxs("div",{className:"text-center p-3 bg-card rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-red-400",children:c.losses}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Losses"})]}),e.jsxs("div",{className:"text-center p-3 bg-card rounded-lg",children:[e.jsxs("div",{className:"text-lg font-bold text-empire-emerald-400",children:[c.winRate.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Win Rate"})]}),e.jsxs("div",{className:"text-center p-3 bg-card rounded-lg",children:[e.jsxs("div",{className:`text-lg font-bold ${c.totalReturn>=0?"text-green-400":"text-red-400"}`,children:[c.totalReturn>=0?"+":"",c.totalReturn.toFixed(2),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Return"})]})]})]})]}),A.length>0&&e.jsxs(z,{children:[e.jsx(L,{children:e.jsxs(B,{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-5 h-5"}),e.jsx("span",{children:"Recent Trades"})]})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-2",children:A.map(d=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-card rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[M(d.action),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[d.action.toUpperCase()," ",d.symbol]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["$",d.price.toFixed(2)," • ",d.confidence*100,"% confidence"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm",children:new Date(d.timestamp).toLocaleTimeString()}),e.jsx($,{variant:"outline",className:"text-xs",children:d.status})]})]},d.id))})})]})]})}export{ge as default};
